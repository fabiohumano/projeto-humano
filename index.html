<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fabio Benedetti | Projeto HUMANO</title>
    
    <!-- Bibliotecas de Design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&display=swap" rel="stylesheet">

    <style>
        :root { --slate-deep: #050505; --amber-glow: #f59e0b; }
        body { font-family: 'Inter', sans-serif; background-color: var(--slate-deep); color: #f4f4f5; margin: 0; overflow-x: hidden; text-align: left; }
        .glass { background: rgba(20, 20, 20, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .page { display: none; animation: fadeIn 0.4s ease-out forwards; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .waveform-bar { width: 4px; background: var(--amber-glow); border-radius: 2px; animation: bounce 0.8s infinite; }
        @keyframes bounce { 0%, 100% { height: 20%; } 50% { height: 100%; } }

        .auth-input { background: #111; border: 1px solid #333; color: white; padding: 12px; border-radius: 8px; width: 100%; outline: none; transition: border 0.3s; }
        .auth-input:focus { border-color: var(--amber-glow); }

        #toast {
            position: fixed; bottom: 20px; right: 20px; padding: 15px 30px; border-radius: 10px;
            background: #10b981; color: white; font-weight: 900; font-size: 12px; text-transform: uppercase;
            transform: translateY(150%); transition: transform 0.3s; z-index: 1000;
        }
        #toast.show { transform: translateY(0); }
        #toast.error { background: #ef4444; }
    </style>
</head>
<body class="selection:bg-amber-500 selection:text-black">

    <!-- Notificação de Status -->
    <div id="toast">Sincronizado!</div>

    <!-- Navegação -->
    <nav class="fixed top-0 w-full z-50 glass py-4 px-6 border-b border-white/5">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3 cursor-pointer" onclick="navigate('home')">
                <div class="w-10 h-10 bg-amber-500 rounded-full flex items-center justify-center font-black text-black text-lg">H</div>
                <div class="flex flex-col leading-none text-left">
                    <span class="text-lg font-black uppercase tracking-tighter text-white leading-none">Fabio Benedetti</span>
                    <span class="text-[8px] text-amber-500 font-bold uppercase tracking-widest mt-1">Projeto HUMANO</span>
                </div>
            </div>
            <div class="hidden md:flex gap-8 text-[10px] font-black uppercase tracking-widest items-center">
                <button onclick="navigate('home')" class="text-white hover:text-amber-500 transition-colors">Início</button>
                <button onclick="navigate('media')" class="text-white hover:text-amber-500 transition-colors">Portfólio</button>
                <button id="admin-btn" onclick="handleAdminGate()" class="bg-amber-500 text-black px-6 py-2 rounded-full hover:bg-amber-400 font-black shadow-lg shadow-amber-500/20">Área Exclusiva</button>
            </div>
        </div>
    </nav>

    <main class="pt-32 pb-20 px-6">
        <div class="max-w-6xl mx-auto">
            
            <!-- HOME -->
            <section id="page-home" class="page active">
                <div class="mb-20 text-left">
                    <p class="text-amber-500 font-bold text-xs uppercase tracking-[0.4em] mb-4 italic">Sapucaia • Rio de Janeiro</p>
                    <h1 id="hero-title" class="text-5xl md:text-8xl font-black tracking-tighter leading-[0.9] mb-8 uppercase text-white">
                        A ALMA DA MÚSICA <br/>É <span class="italic text-amber-500">HUMANA.</span>
                    </h1>
                    <p id="hero-desc" class="text-zinc-500 text-lg md:text-2xl max-w-2xl italic font-light leading-relaxed">
                        Produção musical, mixagem e masterização. O medo rouba sonhos, a música liberta-os.
                    </p>
                </div>
                <div class="grid md:grid-cols-2 gap-8 glass p-10 rounded-[3rem]">
                    <div class="space-y-6 text-left">
                        <p class="text-zinc-400 text-sm italic leading-relaxed">Como produtor musical em Sapucaia, Fabio Benedetti foca na verdade sonora. No Projeto HUMANO, a técnica serve à emoção.</p>
                        <a href="https://wa.me/5532991064759" target="_blank" class="inline-flex items-center gap-3 px-10 py-5 bg-white text-black font-black uppercase text-xs rounded-xl hover:bg-amber-500 transition-all font-bold tracking-widest">Chamar WhatsApp</a>
                    </div>
                    <div class="flex flex-col items-center justify-center p-8 bg-zinc-900/40 rounded-[2rem] border border-white/5">
                        <div class="flex items-end gap-2 h-20 mb-6">
                            <div class="waveform-bar" style="animation-delay: 0.1s"></div>
                            <div class="waveform-bar" style="animation-delay: 0.3s"></div>
                            <div class="waveform-bar" style="animation-delay: 0.2s"></div>
                            <div class="waveform-bar" style="animation-delay: 0.5s"></div>
                        </div>
                        <p class="text-[9px] font-black uppercase text-amber-500 tracking-[0.3em]">Signal Active • 2025</p>
                    </div>
                </div>
            </section>

            <!-- PORTFÓLIO -->
            <section id="page-media" class="page">
                <div class="mb-16 text-center">
                    <h2 class="text-4xl md:text-6xl font-black uppercase tracking-tighter italic text-white mb-4">TRABALHOS <span class="text-amber-500">HUMANOS</span></h2>
                    <div id="gallery" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mt-12 text-left"></div>
                </div>
            </section>

            <!-- LOGIN -->
            <section id="page-login" class="page">
                <div class="max-w-md mx-auto py-20 glass p-10 rounded-[2.5rem] border-amber-500/20 border text-center shadow-2xl">
                    <i data-lucide="lock" class="mx-auto text-amber-500 mb-6 w-10 h-10"></i>
                    <h2 class="text-xl font-black uppercase text-white mb-8 tracking-tighter">Área do Comandante</h2>
                    <form id="login-form" class="space-y-4 text-left">
                        <input type="email" id="email" placeholder="E-mail" class="auth-input" required>
                        <input type="password" id="pass" placeholder="Senha" class="auth-input" required>
                        <button type="submit" class="w-full py-4 bg-amber-500 text-black font-black uppercase text-xs rounded-xl hover:bg-amber-400 font-bold">Aceder ao Painel</button>
                        <p id="err" class="text-red-500 text-[10px] font-black uppercase text-center mt-4 hidden">ACESSO NEGADO</p>
                    </form>
                </div>
            </section>

            <!-- ADMIN -->
            <section id="page-admin" class="page">
                <div class="glass p-10 rounded-[3rem] border-amber-500/20 border-2 text-left">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-12 border-b border-white/5 pb-8 gap-6">
                        <h2 class="text-4xl font-black uppercase italic text-white underline decoration-amber-500">O CÉREBRO</h2>
                        <div class="flex gap-4">
                            <button onclick="handleLogout()" class="px-6 py-2 border border-red-500 text-red-500 rounded-xl text-[10px] font-black uppercase hover:bg-red-500 hover:text-white transition-all">Sair</button>
                            <button onclick="navigate('home')" class="px-6 py-2 bg-white text-black rounded-xl text-[10px] font-black uppercase font-bold">Ver Site</button>
                        </div>
                    </div>

                    <div class="grid lg:grid-cols-2 gap-12">
                        <div class="space-y-6">
                            <h3 class="text-xs font-black uppercase text-amber-500 tracking-widest italic">Manchetes</h3>
                            <div class="space-y-4">
                                <input type="text" id="in-title" placeholder="Título" class="auth-input text-lg font-black uppercase">
                                <textarea id="in-desc" placeholder="Descrição" class="auth-input h-24 italic text-sm text-zinc-300"></textarea>
                                <button onclick="saveGeneral()" id="save-btn" class="w-full py-4 bg-emerald-600 text-white font-black uppercase text-[10px] rounded-xl font-bold">Salvar Manchetes</button>
                            </div>
                        </div>
                        <div class="space-y-6">
                            <h3 class="text-xs font-black uppercase text-amber-500 tracking-widest italic">Novo Trabalho</h3>
                            <div class="space-y-4">
                                <input type="text" id="v-url" placeholder="Link YouTube" class="auth-input text-sm">
                                <input type="text" id="v-title" placeholder="Título" class="auth-input text-sm font-bold uppercase">
                                <button onclick="addVideo()" id="add-btn" class="w-full py-4 bg-white text-black font-black uppercase text-[10px] rounded-xl font-bold">Adicionar</button>
                            </div>
                            <div id="admin-v-list" class="space-y-2 mt-8"></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Scripts do Sistema -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAI6adYwJoxvOpSiCyGZpuEE70NPZXkRZo",
            authDomain: "humano-projeto.firebaseapp.com",
            projectId: "humano-projeto",
            storageBucket: "humano-projeto.firebasestorage.app",
            messagingSenderId: "350003657068",
            appId: "1:350003657068:web:b1b18458dcee0a80701b49"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = "projeto-humano-sapucaia-final";

        let localState = { heroTitle: "A ALMA DA MÚSICA É HUMANA.", heroDesc: "Produção musical, mixagem e masterização.", videos: [] };
        let user = null;

        const showToast = (m, isError = false) => { 
            const t = document.getElementById('toast'); 
            t.innerText = m; 
            t.className = isError ? 'show error' : 'show';
            setTimeout(() => t.classList.remove('show'), 4000); 
        };

        onAuthStateChanged(auth, (u) => {
            user = u;
            const b = document.getElementById('admin-btn');
            if (u && !u.isAnonymous) {
                b.innerHTML = `<i data-lucide="unlock" class="w-3 h-3 inline mr-1"></i> Painel Ativo`;
                b.classList.replace('bg-amber-500', 'bg-emerald-600');
            } else {
                b.innerHTML = `<i data-lucide="lock" class="w-3 h-3 inline mr-1"></i> Área Exclusiva`;
                b.classList.replace('bg-emerald-600', 'bg-amber-500');
            }
            lucide.createIcons();
        });

        const startSync = async () => {
            if (!auth.currentUser) await signInAnonymously(auth);
            
            // Caminho blindado (artifacts / ID / public / data / site / config)
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site', 'config');
            onSnapshot(docRef, (snap) => {
                if (snap.exists()) { 
                    localState = snap.data(); 
                    refreshUI(); 
                } else { 
                    setDoc(docRef, localState).catch(e => console.error("Erro ao criar documento inicial:", e)); 
                }
            }, (err) => {
                console.error("Firebase Sync Error:", err);
                showToast("Erro de Conexão: Verifica as Rules no Firebase!", true);
            });
        };

        const refreshUI = () => {
            document.getElementById('hero-title').innerHTML = (localState.heroTitle || "").replace('HUMANA.', '<span class="italic text-amber-500">HUMANA.</span>');
            document.getElementById('hero-desc').innerText = localState.heroDesc || "";
            const gallery = document.getElementById('gallery');
            if(gallery) gallery.innerHTML = localState.videos?.map(v => `
                <div class="glass rounded-3xl overflow-hidden shadow-2xl">
                    <div class="relative pt-[56.25%]"><iframe class="absolute inset-0 w-full h-full border-0" src="https://www.youtube.com/embed/${v.id}" allowfullscreen></iframe></div>
                    <div class="p-6 text-left"><h4 class="text-white font-black text-[10px] uppercase tracking-widest">${v.title}</h4></div>
                </div>`).join('') || '<p class="text-zinc-700 italic">Nenhum vídeo adicionado.</p>';

            document.getElementById('in-title').value = localState.heroTitle || "";
            document.getElementById('in-desc').value = localState.heroDesc || "";
            const adminList = document.getElementById('admin-v-list');
            if(adminList) adminList.innerHTML = localState.videos?.map((v, i) => `
                <div class="flex justify-between items-center p-4 bg-black border border-white/5 rounded-xl">
                    <p class="text-[10px] font-black uppercase text-zinc-400 truncate max-w-[150px]">${v.title}</p>
                    <button onclick="removeVideo(${i})" class="text-red-500 p-2 hover:bg-red-500/10 rounded-lg transition-all"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                </div>`).join('') || '';
            lucide.createIcons();
        };

        window.navigate = (id) => {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + id).classList.add('active');
            window.scrollTo(0, 0);
            lucide.createIcons();
        };

        window.handleAdminGate = () => { 
            if (user && !user.isAnonymous) navigate('admin'); 
            else navigate('login'); 
        };

        window.saveGeneral = async () => {
            const btn = document.getElementById('save-btn');
            btn.innerText = "Sincronizando...";
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site', 'config');
            try {
                await setDoc(docRef, { 
                    heroTitle: document.getElementById('in-title').value, 
                    heroDesc: document.getElementById('in-desc').value 
                }, { merge: true });
                showToast("Sincronizado com Sucesso!");
            } catch (e) { 
                console.error(e);
                showToast("Erro: " + e.message, true); 
            } finally {
                btn.innerText = "Salvar Manchetes";
            }
        };

        window.addVideo = async () => {
            const u = document.getElementById('v-url').value;
            const t = document.getElementById('v-title').value;
            const id = u.match(/(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/watch\?.+&v=))([\w-]{11})/)?.[1];
            if (!id || !t) return showToast("Faltam Dados!", true);
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site', 'config');
            const newVideos = [ { id, title: t }, ...(localState.videos || []) ];
            try {
                await setDoc(docRef, { videos: newVideos }, { merge: true });
                document.getElementById('v-url').value = ''; document.getElementById('v-title').value = '';
                showToast("Vídeo Publicado!");
            } catch (e) { showToast("Erro ao gravar vídeo", true); }
        };

        window.removeVideo = async (idx) => {
            const nv = [...localState.videos]; nv.splice(idx, 1);
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site', 'config');
            await setDoc(docRef, { videos: nv }, { merge: true });
            showToast("Vídeo Removido");
        };

        document.getElementById('login-form').onsubmit = async (e) => {
            e.preventDefault();
            const em = document.getElementById('email').value;
            const pw = document.getElementById('pass').value;
            try { await signInWithEmailAndPassword(auth, em, pw); navigate('admin'); } catch (e) { 
                document.getElementById('err').classList.remove('hidden'); 
            }
        };

        window.handleLogout = async () => { await signOut(auth); navigate('home'); };

        startSync();
        window.onload = () => { lucide.createIcons(); };
    </script>
</body>
</html>
